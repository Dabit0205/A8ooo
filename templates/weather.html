<!doctype html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <title>미세먼지 API로Fetch 연습하고 가기!</title>


    <style type="text/css">
        div.question-box {
            margin: 10px 0 20px 0;
        }
    </style>

    <script>
        function q1() {
            fetch("http://127.0.0.1:8000/articles/weather/", {method:"GET"}).then((response) => response.json()).then((data) => {
                    $('#names-q1').empty()
										let items = data['response']['body']['items']['item']
                    items.forEach((a) => {
                        let category = a['category']
												let obsrValue = a['obsrValue']
                        let temp_html = `<li>${category} : ${obsrValue}</li>`
                        $('#names-q1').append(temp_html)
                    });
                })
            }
        function getCookie(name) { 
            var nameOfCookie = name + "="; 
            var x = 0;
            while (x <= document.cookie.length) {
                var y = (x + nameOfCookie.length);
                if (document.cookie.substring(x, y) == nameOfCookie) {
                    if ((endOfCookie = document.cookie.indexOf(";", y)) == -1) 
                return unescape(document.cookie.substring(y, endOfCookie));

                }
                x = document.cookie.indexOf(" ", x) + 1;
                if (x == 0)
                    break;
            }
            return "";
        }
        function testing() {
            var cookie = getCookie('items');
            if(cookie != "") {
                alert(cookie)
            }
        }
        function test2(){ 
            var a = sessionStorage.getItem("items");
            alert(a)
        }   
    </script>

</head>

<body>
    <h1>Fetch 연습하자!</h1>

    <hr/>
    
    <div class="question-box">
        <h2>1. 서울시 OpenAPI(실시간 미세먼지 상태)를 이용하기</h2>
        <p>모든 구의 미세먼지를 표기해주세요</p>
        <p>업데이트 버튼을 누를 때마다 지웠다 새로 씌여져야 합니다.</p>
        <button onclick="test2()">업데이트</button>
    </div>

    <form class="form-area" method="post" action="/articles/weather/">
        {% csrf_token %}
        <button type="submit" class="btn btn-primary">회원가입</button>
        <h3>{{rain}}</h3>
    </form>
</body>

</html>